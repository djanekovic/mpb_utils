\documentclass[utf8, seminar]{fer}
\usepackage{booktabs}
\usepackage{hyperref}
\usepackage{siunitx}
\usepackage{amsmath}


\begin{document}

\title{Analiza periodičkih struktura s naglaskom na fotoničke kristale
	   i izračun disperzijskog dijagrama}
\author{Darko Janeković}
\voditelj{dr.sc. Dario Bojanjac}

\maketitle

\tableofcontents


\chapter{Uvod}
U ovom seminaru bit će riječi o analizi periodičkih struktura gdje će naglasak
biti na fotoničkim kristalima i primjeni numeričkih metoda na izračun
disperzijskog dijagrama. Programska biblioteka koja se koristi za numeričko
modeliranje je \href{https://github.com/stevengj/mpb}{MPB}. Prije svega, bit će
iznesena matematička podloga potrebna za efikasno modeliranje širenja vala u
periodičkoj strukturi. U poglavljima nakon uvoda bit će iznesena primjena
fotoničkih kristala, kao i numeričke metode korištene u svrhu modeliranja
problema koji opisuju periodičke strukture.


\chapter{Matematičko modeliranje širenja vala u periodičkoj strukturi}

%SADŽAJ POGLAVLJA: prvo napiši nešto o periodičkim strukturama/simetrija/rešetka
% Blochov teorem
% Valna za širenje vala u nehomogenom dielektriku
% Njena interpretacija, kako će se odnositi energija i slično
% Sve spoji u jedno i onda spomeni svojstveni problem kako se on rješava i da
% će sve dalje biti računato iz te jednadžbe

U ovom poglavlju nešto će detaljnije biti iznesena teorija periodičkih struktura
kao i matematički formalizam koji ih opisuje. Analiza propagacije vala unutar
periodičke rešetke prirodno navodi na Blochov teorem. On tvrdi da će polje u
periodičkoj strukturi poprimiti isti period i simetriju kao i period te strukture.
Kao polazišna točka bit će izvedena valna jednadžba za propagaciju vala unutar
nehomogenog dielektrika. Svojstveni problem i njegova interpretacija bit će
razmatrani baš u okvirima te jednadžbe. Konačno će jednadžba pomoću Blochovog
teorema biti specijalizirana za slučaj fotoničkog kristala.


\section{Periodičke strukture i kristalna rešetka}

Periodička struktura je pravilna struktura u kojoj se elementi na neki način
periodički ponavljaju. U nastavku će biti razmatrani fotonički kristali koji se
mogu razmatrati kao kristalne rešetke. Fotonički kristali periodični su na način
da zadovavaju diskretnu translacijsku simetriju.
Diskretna translacijska simetrija definirana je kao
${f(\mathbf{r}) = f(\mathbf{r} \pm \mathbf{a})}$, odnosno

\begin{equation}
	f(\mathbf{r}) = f(\mathbf{r} + \mathbf{R}) \text{, gdje je }{\mathbf{R} =
	n\mathbf{a}} \text{, a } n \in \mathbb{Z}
\end{equation}

Vektor $\mathbf{a}$ naziva se primitivni vektor rešetke, a njegova duljina
naziva se konstanta rešetke. Ćelija za koju se tvrdi da svojim ponavljanjem
tvori kristalnu rešetku naziva se jedinična ćelija. Jedinična ćelija je
najmanja jedinica kristalne rešetke koja svojim ponavljanjem može tvoriti
potpunu rešetku. Pored toga, ne postoji ćelija manjeg volumena od
${|\mathbf{a}_1 \cdot \mathbf{a}_2 \times \mathbf{a}_3|}$, odnosno volumena
kojeg zatvaraju primitivni vektori rešetke.

%NOTE: bilo bi zgodno da ovdje ubacim sliku kristalne rešetke sa svim ucrtanim vektorima

Ovisno o dimenzionalnosti problema moguće je odabrati različite primitivne
vektore rešetke i sve ostale translacije prikazati kao linearnu kombinaciju
primitivnih vektora.

Weigner-Seintzova ćelija primjer je primitivne ćelije koja sadrži samo jedno
čvorište i predstavlja skup točaka u prostoru koji je bliži jednom čvorištu
od bilo kojeg drugog čvorišta. Čvorišta kristalne rešetke nalaze se u središtu
Weigner-Seintzova ćelije. Iako kristal ima beskonačno puno jediničnih ćelija,
on ima samo jednu Weigner-Seintzovu ćeliju.

Recipročna rešetka uvodi se za prikaz valnih vektora u Fourierovom razvoju
periodičkih funkcija. Vektori recipročne rešetke bit će označavani s $\mathbf{b}$.
Za vektore recipročne rešetke vrijedi:

\begin{equation}
	\mathbf{R} \cdot \mathbf{G} =
	(n_1\mathbf{a}_1 + n_2\mathbf{a}_2 + n_3\mathbf{a}_3)
	\cdot
	(m_1\mathbf{b}_1 + m_2\mathbf{b}_2 + m_3\mathbf{b}_3) = 2 \pi \mathbb{N},
		\text{ gdje je }n_i, m_i \in \mathbb{Z}
\end{equation}


Weigner-Seintzova ćelija recipročne rešetke zove se Brillouinova zona. Analiza
disperzijskog dijagrama obavlja se u \textit{k prostoru}, prostoru recipročne
rešetke, odnosno u prvoj Brillouinovoj zoni. Prva Brillouinova zona je najmanji
prostor unutar Brillouinove zone koji u potpunosti karakterizira polje unutar
periodičke strukture. Svaku točku unutar Brillouinove zone moguće je preslikati
u prvu Brillouinovu zonu. Drugim riječima, analiza širenja vala unutar
Brillouinove zone, bit će ekvivalentna analizi unutar prve Brillouinove zone uz
određenu redundantnost u računu. Što je rešetka više simetrična, to će biti
isplativije analizu obavljati unutar prve Brillouinove zone.


\section{Blochov teorem}

Intuitivnim razmišljanjem jasno je da će val koji je u jednom trenutku prolazio
kroz dielektrični objekt kasniti u odnosu na val koji nije. Lako je onda
generalizirati ideju na periodičku strukturu i iz tog razmišljanja izvući
zaključak da će polje unutar periodičke strukture poprimiti isti period i
simetriju kao i ta struktura. Teorem koji je upravo intuitivno izveden naziva se
Blochov teorem, i matematički formaliziran glasi ovako:

\begin{equation} \label{eq:bloch}
	\mathbf{E}(\mathbf{r}) =
	\mathbf{A}_\mathbf{\beta}(\mathbf{r}) \cdot
		e^{j \mathbf{\beta} \cdot \mathbf{r}}
\end{equation}

U jednadžbi \ref{eq:bloch}, vektorsko polje $\mathbf{E}$ označava ukupno polje
u periodičkoj strukturi i ono se sastoji od dvije komponente. Vektorsko polje
$\mathbf{A}$ označava envelopu s istim periodom i simetrijom kao i rešetka.
Ono diktira amplitudu ukupnog polja $\mathbf{E}$.
Komponenta ${e^{j \mathbf{\beta} \cdot \mathbf{r}}}$ označava ravni val i diktira
smjer širenja vala.

% todo: ubaci meep sliku kako to izgleda i napiši par riječi o tome

% todo: matematički potkrijepi gore napisano + pročitaj više o ovome


\section{Izvod valne jednadžbe za širenje u sredstvu s nehomogenim dielektrikom}

U ovom potpoglavlju bit će izvedena valna jednadžba koja opisuje propagaciju
vala u nehomogenom dielektriku. Sredstvo u kojem val propagira nalikuje sredstvu
na slici \ref{fig:structure}.

% TODO: label i uredi sliku
\begin{figure}
	\centering
	\includegraphics[width = 1.0\linewidth]{./images/structure-model.pdf}
	\caption{Model strukture u kojoj propagira val. Sredstvo je sastavljeno od
	neperiodičnih, homogenih ``zakrpa'' različitih dielektričnih materijala.}
	\label{fig:structure}
\end{figure}

Izvod valne jednadžbe, kao i za slučaj propagacije u homogenom sredstvu počinje
s Maxwellovim jednadžbama:

\begin{align} \label{eq:maxwell1}
	\nabla \cdot \mathbf{D} = \rho &&
	\nabla \times \mathbf{E} &=
		- \frac{\partial \mathbf{B}}{\partial t}  \nonumber \\
	\nabla \cdot \mathbf{B} = 0 &&
	\nabla \times \mathbf{H} &=
		\mathbf{J} + \frac{\partial \mathbf{D}}{\partial t}
\end{align}

$\varepsilon$ u sredstvu postaje funkcija koja ovisi o položaju, odnosno
$\varepsilon(\mathbf{r})$. Pored toga, pretpostavlja se da struktura ne mijenja
konfiguraciju u vremenu, te da u njoj nema izvora svjetlosti. Između ostalog
pretpostavlja se da su snage dovoljno male kako bi sustav imalo smisla promatrati
u linearnom režimu.
% NOTE: napiši što se koristi u protivnom, Bloembergen suma (2)
Materijal u kojem se vrši propagacija promatra se kao izotropan na makroskopskoj
razini. U slučaju anizotropnog medija $\mathbf{D}$ i $\mathbf{E}$ nisu vezani
s $\varepsilon_0 \varepsilon$, već s
%TODO: potkrijepi citatom iz dario knjige + pročitaj više
dielektričnim tenzorom $\varepsilon_0 \varepsilon_{ij}$. Frekvencijska
ovisnost dielektrične permeabilnosti bit će zanemarena. Konačno, nakon svih
pretpostavki jednadžbe \ref{eq:maxwell1} poprimaju sljedeći oblik:

\begin{align} \label{eq:maxwell2}
	\nabla \cdot (\varepsilon(\mathbf{r}) \mathbf{E}(\mathbf{r}, t)) = 0 &&
	\nabla \times \mathbf{E}(\mathbf{r}, t) &=
		- \mu_0 \mu(\mathbf{r})
		\frac{\partial \mathbf{H}(\mathbf{r}, t)}{\partial t}  \nonumber \\
	\nabla \cdot \mathbf{H}(\mathbf{r}, t) = 0 &&
	\nabla \times \mathbf{H}(\mathbf{r}, t) &=
		\varepsilon_0 \varepsilon(\mathbf{r}, t)
		\frac{\partial \mathbf{E}(\mathbf{r}, t)}{\partial t}
\end{align}

Budući da su Maxwellove jednadžbe linearne, moguće je pretpostaviti da će pobuda
titrati istom frekvencijom kao i odziv. To svojstvo omogućava rastav polja
na prostornu i vremensku komponentu. Rastav se obavlja preko sljedećeg zapisa:
% TODO: citat dario knjiga
% napiši i pročitaj više o ovome
\begin{equation} \label{eq:harmonic}
	\mathbf{H}(\mathbf{r}, t) = \mathbf{H}(\mathbf{r}) e^{-i \omega t}
\end{equation}

Nakon uvrštavanja \ref{eq:harmonic} Maxwellove jednadžbe poprimaju sljedeći
oblik:

\begin{align} \label{eq:maxwell3}
	\nabla \cdot (\varepsilon(\mathbf{r}) \mathbf{E}(\mathbf{r})) = 0 &&
	\nabla \times \mathbf{E}(\mathbf{r}) &=
		i \omega \mu_0 \mu(\mathbf{r})\mathbf{H}(\mathbf{r})  \nonumber \\
	\nabla \cdot \mathbf{H}(\mathbf{r}) = 0 &&
	\nabla \times \mathbf{H}(\mathbf{r}) &=
		- i \omega \varepsilon_0 \varepsilon(\mathbf{r})\mathbf{E}(\mathbf{r})
\end{align}

Djelujući operatorom rotora na jednadžbu koja opisuje Faradayev zakon dobiva
se valna jednadžba u sljedećem obliku:

\begin{equation} \label{eq:master}
	\nabla \times \left(\frac{1}{\varepsilon(\mathbf{r})}\nabla
			\times \mathbf{H}(\mathbf{r}) \right)
	= \left( \frac{\omega}{c} \right)^2 \mathbf{H}(\mathbf{r})
\end{equation}

Jednadžba \ref{eq:master} predstavljat će jednadžbu koja će biti korištena za
računanje disperzijskog dijagrama u nehomogenom dielektriku.
Ako se operator ${\nabla \times \frac{1}{\varepsilon(\mathbf{r})} \nabla \times}$
zamijeni s $\hat{\mathbf{\Theta}}$ dobiva se uobičajena forma svojstvenog
problema.

\begin{equation}
	\hat{\mathbf{\Theta}} \mathbf{H}(\mathbf{r}) =
		\left( \frac{\omega}{c} \right)^2 \mathbf{H}(\mathbf{r})
\end{equation}

Budući da je operator $\hat{\mathbf{\Theta}}$ hermitski
\footnote{
	Potrebno je dokazati da je ${(\mathbf{F}, \hat{\mathbf{\Theta}}\mathbf{G})
	=(\hat{\mathbf{\Theta}} \mathbf{F}, \mathbf{G})}$.

	$$(\mathbf{F}, \hat{\mathbf{\Theta}}\mathbf{G}) =
	\iiint \mathbf{F}^* (\mathbf{r}) \cdot \nabla \times \left(
		\frac{1}{\varepsilon (\mathbf{r})} \nabla \times \mathbf{G}(\mathbf{r})
	\right) \, \mathrm{d}^3 \mathbf{r}$$

	% dario citat
	Koristeći formulu za parcijalnu integraciju operacije rotora i Gaussov
	teorem izraz se svodi na

	%todo: ako će ti se dati ubaci oiint umjesto oint

	$$(\mathbf{F}, \hat{\mathbf{\Theta}}\mathbf{G}) =
	\iiint \frac{1}{\varepsilon (\mathbf{r})} \nabla \times \mathbf{G}(\mathbf{r})
	\cdot \left(
		\nabla \times \mathbf{F}(\mathbf{r})
	\right)^* \, \mathrm{d}^3 \mathbf{r}
	- \oint \left(
		\mathbf{F}^*(\mathbf{r}) \times \frac{1}{\varepsilon(\mathbf{r})}
		\nabla \times \mathbf{G}(\mathbf{r})
	\right) \hat{n} \, \mathrm{d}S$$

	Drugi član izraza zanemaruje se ili zbog periodičnosti na području integracije
	% todo: napiši ovo bolje: field decay to zero at large distances
	ili zato što polja trnu u 0 pri velikim udaljenostima. Parcijalna integracija
	provodi se još jednom uz zanemarivanje istog člana kao i ranije.

	$$(\mathbf{F}, \hat{\mathbf{\Theta}}\mathbf{G}) =
	\iiint \mathbf{G}(\mathbf{r})
	\cdot \left[
		\nabla \times \left(
			\frac{1}{\varepsilon (\mathbf{r})} \nabla \times
			\mathbf{F}(\mathbf{r})
		\right)
	\right]^* \, \mathrm{d}^3 \mathbf{r}
	- \oint \left[
		\left(
			\frac{1}{\varepsilon(\mathbf{r})} \times \mathbf{F}(\mathbf{r})
		\right)^*
		\times \mathbf{G}(\mathbf{r})
	\right] \hat{n} \, \mathrm{d}S
	= (\hat{\mathbf{\Theta}} \mathbf{F}, \mathbf{G})$$
%	$$(\mathbf{F}, \hat{\mathbf{\Theta}}\mathbf{G}) =
%	\iiint \mathbf{G}(\mathbf{r})
%	\cdot \left[
%		\nabla \times \left(
%			\frac{1}{\varepsilon (\mathbf{r})} \nabla \times
%			\mathbf{F}(\mathbf{r})
%		\right)
%	\right]^* \, \mathrm{d}^3 \mathbf{r}
%	= (\hat{\mathbf{\Theta}} \mathbf{F}, \mathbf{G})$$
},
moguće je analizirati njegov Rayleighov kvocijent
$R \left(\hat{\mathbf{\Theta}}, \mathbf{H}(\mathbf{r}) \right)$.

Može se pokazati da će najmanja svojstvena vrijednost $\omega_0^2/c^2$, a
shodno tome i najniži harmonik biti povezani s konfiguracijom polja koja
minimizira Rayleighov koeficijent.

%TODO: ovo je čudan rezultat i treba ga provjeriti
\begin{align} \label{eq:rayleighM}
	R \left( \hat{\mathbf{\Theta}}, \mathbf{H}(\mathbf{r}) \right)
	&= \frac{ \left(
		\mathbf{H}(\mathbf{r}), \hat{\mathbf{\Theta}}\mathbf{H}(\mathbf{r})
		\right)}
	{
		(\mathbf{H}(\mathbf{r}), \mathbf{H}(\mathbf{r}))
	}
	= \frac{ 1/\varepsilon(\mathbf{r})
		\iiint |\nabla \times \mathbf{H}(\mathbf{r})|^2
		\, \mathrm{d}^3\mathbf{r}}
	{\iiint | \mathbf{H}( \mathbf{r} ) |^2
		\, \mathrm{d}^3\mathbf{r}} 								\nonumber \\
	&= \frac{
		\iiint |\nabla \times \mathbf{H}(\mathbf{r})|^2
		\, \mathrm{d}^3\mathbf{r}}
	{\iiint \varepsilon(\mathbf{r}) | \mathbf{H}( \mathbf{r} ) |^2
		\, \mathrm{d}^3\mathbf{r}}										  \\
	R \left( \hat{\mathbf{\Theta}}, \mathbf{H}(\mathbf{r}) \right)
	&= \frac{
		\omega^2/c^2
		\left(
			\mathbf{H}(\mathbf{r}), \mathbf{H}(\mathbf{r})
		\right)
	}
	{
		\omega^2/c^2
		\left(
			\mathbf{H}(\mathbf{r}), \hat{\mathbf{\Theta}}\mathbf{H}(\mathbf{r})
		\right)
	}
	= \frac{
		\iiint |\nabla \times \mathbf{E}(\mathbf{r})|^2
		\, \mathrm{d}^3\mathbf{r}}
	{\iiint \varepsilon(\mathbf{r}) | \mathbf{E}( \mathbf{r} ) |^2
	\, \mathrm{d}^3\mathbf{r}} \label{eq:rayleighE}
\end{align}

Iz izraza \ref{eq:rayleighM} i \ref{eq:rayleighE}, jasno je da se
${R \left( \hat{\mathbf{\Theta}}, \mathbf{H}(\mathbf{r}) \right)}$ može
minimizirati tako da se maksimizira nazivnik, odnosno
${\varepsilon (\mathbf{r})}$. Rezultat se interpretira kao svojevrsna heuristika
gdje u fotoničkom kristalu očekivati da će biti koncentrirana energija.

\section{Propagacija vala unutar periodičke strukture}

Koristeći rezultat \ref{eq:master} i uvrštavajući \ref{eq:bloch} umjesto
$\mathbf{H}(\mathbf{r})$ dobiva se diferencijalna jednadžba koja predstavlja
svojstveni problem propagacije vala unutar fotoničkog kristala odnosno
periodičke strukture.

\begin{align} \label{eq:master_bloch}
	\nabla \times
	\frac{1}{\varepsilon(\mathbf{r})} \nabla \times
	\mathbf{H}_\mathbf{\beta}(\mathbf{r}) \cdot
	e^{j \mathbf{\beta} \cdot \mathbf{r}}
	= \left(
		\frac{\omega}{c}
	\right)^2
	\mathbf{H}_\mathbf{\beta}(\mathbf{r}) \cdot
		e^{j \mathbf{\beta} \cdot \mathbf{r}}	\nonumber \\
	(\nabla + j\mathbf{\beta}) \times
	\frac{1}{\varepsilon(\mathbf{r})}
	(\nabla + j\mathbf{\beta}) \times
	\mathbf{H}_\mathbf{\beta}(\mathbf{r})
	= \left(
		\frac{\omega}{c}
	\right)^2
	\mathbf{H}_\mathbf{\beta}(\mathbf{r})
\end{align}

Jednadžba \ref{eq:master_bloch} predstavlja završnu jednadžbu koja služi za
proračun disperzijskog dijagrama u fotoničkom kristalu. Ovaj oblik
svojstvenog problema rješava programska biblioteka MPB spomenuta ranije. Sva
svojstva izvedena ranije, vrijede i za gore izvedenu jednadžbu.

\chapter{Proračun disperzijskog dijagrama fotoničkih kristala}

U poglavljima koja slijede bit će proračunat i prikazan disperzijski dijagram
osnovnih kristalnih rešetki. Prvo će biti prikazane konfiguracije koje
osiguravaju \textit{band gap} za TE, potom za TM, a onda i za oboje odnosno
potpuni band gap.

\section{Kvadratna rešetka dielektričnih stupića}

U ovom primjeru, fotonički kristal građen je od dielektričnih stupića
postavljenih tako da gledano iz smjera z osi odnosno ``odozgo'' izgledaju kao
slika \ref{fig:square_lattice}

%todo: label i caption
\begin{figure}[h]
	\centering
	\includegraphics[width = 1.0\linewidth]{./images/square_lattice.pdf}
	\caption{Kvadratna rešetka s ucrtanim baznim vektorima i Weigner-Seintzovom
	ćelijom}
	\label{fig:square_lattice}
\end{figure}

Bazni vektori rešetke su vektori ${\mathbf{a}_1 = a \hat{\mathbf{y}}}$ i
${\mathbf{a}_2= a \hat{\mathbf{x}}}$, a Weigner-Seintzova ćelija označena je
desno žutom bojom.
%todo: izračunaj vektore recipročne rešetke
Bazni vektori recipročne rečetke su \dots, a prva Brillouinova zona prikazana
je na disperzijskom dijagramu.

%ubaci sliku disperzijskog dijagrama

\section{Trokutasta rešetka dielektričnih stupića}

U ovom primjeru, fotonički kristal građen je od dielektričnih stupića
postavljenih tako da gledano iz smjera z osi, odnosno ``odozgo'' izgledaju kao
slika \ref{fig:triangular_lattice}

%todo: label i caption
\begin{figure}[h]
	\centering
	\includegraphics[width = 1.0\linewidth]{./images/triangular_lattice.pdf}
	\caption{Trokutasta rešetka s ucrtanim baznim vektorima i Weigner-Seintzovom
	ćelijom}
	\label{fig:triangular_lattice}
\end{figure}

Bazni vektori rešetke su vektori
${\mathbf{a}_1 = \frac{a}{2} \hat{\mathbf{x}} +
\frac{a \sqrt{3}}{2} \hat{\mathbf{y}}}$ i
${\mathbf{a}_2 = \frac{a}{2} \hat{\mathbf{x}} -
\frac{a \sqrt{3}}{2} \hat{\mathbf{y}}}$.
a Weigner-Seintzova ćelija označena je desno žutom bojom.
%todo: izračunaj vektore recipročne rešetke
Bazni vektori recipročne rečetke su \dots, a prva Brillouinova zona prikazana
je na disperzijskom dijagramu.

%ubaci sliku disperzijskog dijagrama
\chapter{Zaključak}
Zaključak.

\bibliography{literatura}
\bibliographystyle{fer}

\chapter{Sažetak}
Sažetak.

\end{document}
